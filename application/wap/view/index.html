<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta name="keywords" content="船票,三峡船票,船票,重庆三峡船票销售中心"/>
    <meta name="description"
          content="重庆三峡游轮船票销售中心属于重庆长江国际旅游公司，主要经营长江游轮旅游，是长江上最早从事长江三峡旅游业务的大型综合旅游国企，也是目前长江上规模最大、实力最强、安全最具保障的专业化旅游公司。">
    <title>重庆三峡船票销售中心</title>
    <link rel="stylesheet" type="text/css" href="__CSS__/style.css"/>
    <link rel="stylesheet" type="text/css" href="__CSS__/slstyle.css"/>
    <script src="__JS__/jquery-2.1.0.js" type="text/javascript" charset="utf-8"></script>

    <link rel="stylesheet" href="__CSS__/kuCity.css">
    <script src="__JS__/kuCity.js"></script>
	  <script type="text/javascript" src="/static/home/js/swiper-4.2.2.min.js"></script>
    <link rel="stylesheet" type="text/css" href="__CSS__/simple-calendar.css">
    <script type="text/javascript" src="__JS__/simple-calendar.js"></script>

    <link rel="stylesheet" type="text/css" href="__CSS__/datedropper.css">
    <script src="__JS__/datedropper.min.js"></script>
      <link rel="stylesheet" type="text/css" href="/static/home/css/swiper-4.2.2.min.css">

</head>

<body>
    {include file="public/common" /}
<div class="topnavs">
    <img src="__IMG__/logo.jpg" class="navBtn"/>
    <div class="center">
        {$title}
    </div>
    <img class="callbtn" src="__IMG__/call.jpg" tel="{$tel}"/>
</div>
<!-- 弹出popup 框-->
<div class="navsmodel">
    <a href="{:url('rich/rich')}">
        <div class="navList">豪华游轮</div>
    </a>
    <a href="{:url('common/common')}">
        <div class="navList">普通游轮</div>
    </a>
    <a href="{:url('problem/aboutuss')}">
        <div class="navList">关于我们</div>
    </a>
    <a href="{:url('problem/question')}">
        <div class="navList">常见问题</div>
    </a>
</div>
<!-- 主题 main -->
<div class="mainContent">

    <!-- <div class="homeBack">
        <img src="__IMG__/home_back.jpg" alt="">
    </div> -->
      <div class="swiper-container">
          <div class="swiper-wrapper">
              <div class="swiper-slide"><img src="__IMG__/banner/banner.png" alt=""></div>
              <div class="swiper-slide"><img src="__IMG__/banner/banner1.png" alt=""></div>
              
          </div>
          <!-- 如果需要分页器 -->
          <div class="swiper-pagination"></div>
          
         
          
          <!-- 如果需要滚动条 -->
          <div class="swiper-scrollbar"></div>
      </div>

      <script>        
    var mySwiper = new Swiper ('.swiper-container', {
      direction: 'horizontal',
      loop: true,
      
      // 如果需要分页器
      pagination: {
        el: '.swiper-pagination',
      },
      // 如果需要滚动条
      scrollbar: {
        el: '.swiper-scrollbar',
      },
      autoplay:true,
     
    })        
    </script>

    <div class="chooseBox">
        <div class="areabox">
            <div class="cArea">
                <input type="text" class="search1" value="重庆" readonly="readonly">
            </div>
            <div class="cArea cenbtn">
                <div class="imgbox imgboxA">
                    <img src="__IMG__/icon_rs.png" alt="">
                    <img src="__IMG__/icon_lk.png" alt="">
                </div>
                <span>点击切换</span>
            </div>
            <div class="cArea">
                <input type="text" class="search2" value="宜昌" readonly="readonly">
            </div>
        </div>
        <div class="timeBox">
            <div class="ltime">
                <img src="__IMG__/before.png" class="rlImg imgs1" alt="">
                <img src="__IMG__/before_c.png" class="rlImg imgs2" alt="">
                前一天
            </div>
            <div class="ctimes">
                <div class="showTime">
                    <img src="__IMG__/data.png" class="data " alt="">
                    <input type="text" class="input " id="pickdate" readonly="readonly"/>
                    <input class="spSty" value="今天" readonly="readonly"/>
                    <!--<img src="images/dwon.png" class="dwon" alt="" id="pickdate"> -->
                </div>
            </div>
            <div class="rtime">
                后一天
                <img src="__IMG__/after_c.png" class="rlImg" alt="">  
            </div>
        </div>
    </div>
    <div class="chooseType">
        {if isset($list)}
        {foreach list as $k=>$v}
        <div class="typeOne typeOne0">
            <a href="{:url('rich/richDetail')}?s_id={$v.s_id}">
                <span>{$v['r_name']}</span>
                <span>RMB{$v['reference_price']}</span>
            </a>
        </div>
        {/foreach}
        {else}
        <div class='noShip'>今日无船开航</div>
        {/if}
    </div>
    <div class="listBox">
        <div class="lists">
            <div class="lhead">
                <img src="__IMG__/head_hao.jpg" alt="">  
            </div>
            <div class="rich_one">
                <div class="banImg">
                    <a href="{:url('rich/richDetail')}?s_id={$voyagess1[0]['s_id']}"><img
                            src="/uploads/images/{$voyagess1[0]['s_img']}" alt=""></a>
                </div>
                <div class="btnBox">
                    <div class="btns scheduleone" s_id="{$voyagess1[0]['s_id']}">航期</a></div>
                    <div class="btns cenBtn"><a href="{:url('rich/richDetail')}?s_id={$voyagess1[0]['s_id']}">介绍</a>
                    </div>
                    <div class="btns yuding" s_id="{$voyagess1[0]['s_id']}">预订</div>
                </div>
                <div class="nabox">
                    <span>{$voyagess1[0]['r_name']}</span> <span>¥{$voyagess1[0]['reference_price']}起</span>
                </div>
                <!-- 航期 -->
                <div class="voyage hoemvoi typevoyaone">
                    <div id='containerone'></div>
                    <div class="chooseArea">
                        <div class="leshows"  s_id="{$voyagess1[0]['s_id']}">‹</div>
                        <span class="contss  hide">宜昌到重庆</span>
                        <span class="contshow show">重庆到宜昌</span>
                        <div class="leshows"  s_id="{$voyagess1[0]['s_id']}">›</div>
                    </div>
                </div>
            </div>
            <div class="typeBox">
                <span class="typeshow chosec">全部</span>
            </div>

            <div class="moreBox" id="rich_more">
                <div class="moreBtn" id="rich_click">更多豪华邮轮 <img src="__IMG__/more_icon.png" alt=""></div>
            </div>
        </div>
    </div>


    <div class="listBox">
        <div class="lists">
            <div class="lhead">
                <img src="__IMG__/head_pu.jpg" alt="">   
            </div>
            <div class="common_one">
                <div class="banImg">
                    <a href="{:url('common/commonDetail')}?s_id={$voyages[0]['s_id']}"><img
                            src="/uploads/images/{$voyages[0]['s_img']}" alt=""></a>
                </div>
                <div class="btnBox">
                    <div class="btns scheduletwo" s_id="{$voyages[0]['s_id']}">航期</div>
                    <div class="btns cenBtn"><a
                            href="{:url('common/commonDetail')}?s_id={$voyages[0]['s_id']}">介绍</a></div>
                    <div class="btns yuding" s_id="{$voyages[0]['s_id']}">预订</div>
                </div>
                <div class="nabox ">
                    <span>{$voyages[0]['p_name']}</span> <span>¥{$voyages[0]['reference_price']}起</span>
                </div>
                <!-- 航期 -->
                <div class="voyage hoemvoi typevoyatwo">
                    <div class="containertwo" id="containertwo_{$voyages[0]['s_id']}"></div>
                    <div class="chooseArea">
                        <div class="leshows s_t" s_id="{$voyages[0]['s_id']}">‹</div>
                        <span class="contss  hide">宜昌到重庆</span>
                        <span class="contshow show">重庆到宜昌</span>
                        <div class="leshows s_t" s_id="{$voyages[0]['s_id']}">›</div>
                    </div>
                </div>
            </div>
            <div class="moreBox" id="common_more">
                <div class="moreBtn" id="common_click">更多普通邮轮 <img src="__IMG__/more_icon.png" alt=""></div>
            </div>
        </div>
    </div>
    <div class="consult">
        咨询电话: {$tel}
    </div>
    <div class="foot">
        <span>Copyright©2010-2018 重庆三峡船票销售中心</span>
        <span>旅行社经营许可证号：L-HUB-CJ00003</span>
        <span>渝ICP备09022178号</span>
        <span>渝公网安备 42010302000544号</span>
    </div>
</div>
<!-- 弹窗 订票 -->
<div class="poppup"  scoll=no>
            <div class="formBox">
                <div class="turnoff">×</div>
                <input type="hidden" name='v_id' id="v_id"/>
                <input type="hidden" name='s_id' id="s_id"/>
                <div class="oneitem">
                    <div class="lboxo">乘坐邮轮</div><div class="rboxo"> <span class="shipsName"></span></div>
                </div>
                <div class="oneitem">
                    <div class="lboxo">选择航程</div><div class="rboxo"> <div class="direction chooseWay" start="cy">重庆到宜昌</div> <div class="direction" start="yc">宜昌到重庆</div></div>
                </div>
                <div class="oneitem">
                    <div class="lboxo">选择时间</div><div class="rboxo">
                        <div class="ctimes widon">
                            <div class="showTime">
                                <img src="__IMG__/data.png" class="data" alt="">
                                <input type="text" class="input" id="pickdate2"/>
                                <input class="spSty" id='spSty2' value="今天"  readonly="readonly"/>
                                <!--<img src="__IMG__/dwon.png" class="dwon" alt="" id="pickdate"> -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="oneitem">
                    <div class="lboxo">预订价格</div>
                    <div class="rboxo"> 
                        <div class="exhibition">成人<span class="cored" id='adult_money'>0</span>元/人 </div>  
                        <div class="">儿童<span class="cored" id='child_money'>0</span>元/人</div>
                    </div>
                </div>
                <div class="oneitem">
                    <div class="lboxo">参团人数</div>
                    <div class="rboxo">
                        <div class="adult aduloth">成人
                            <input class="btninput noadd" id="minNum" name="" type="button" value="-" />  
                            <input class="shownum " id="quantity" name="" type="text" value="0" readonly />  
                            <input class="btninput" id="addNum" name="" type="button" value="+" />人 
                        </div>
                        <div class="adult">儿童
                            <input class="btninput noadd" id="childmin" name="" type="button" value="-" />  
                            <input class="shownum" id="childc" name="" type="text" value="0" readonly/>  
                            <input class="btninput" id="childadd" name="" type="button" value="+" />人  
                        </div>
                    </div>
                </div>
                <div class="oneitem">
                    <div class="lboxo">合计费用</div><div class="rboxo"> <span class="cored" >¥<input style="width: 200px" type="" name="" id="totalNum" value="" readonly/></span></div>
                </div>
                <div class="oneitem">
                    <div class="lboxo">您的姓名</div><div class="rboxo"> <input id='username' class="inputin" type="text" placeholder="请输入您的姓名" name=""></div>
                </div>
                <div class="oneitem">
                    <div class="lboxo">手机号码</div><div class="rboxo"> <input id='telphone' class="inputin" type="number"  placeholder="请输入您的手机号码" name=""></div>
                </div>
                <div class="btnBox">
                    <button type="button" id='sub2'>确定</button>
                </div>
            </div>
        </div>
<!-- 弹窗 选择船 -->
<div class="shipBox">
    <div class="poptype">
        <div class="altype">
            <div class="listone">全部 <input whname="全部" type="radio" name="radio" value="0" id="aa" checked> <label
                    for="aa"></label></div>
            {foreach wholes as $k=>$v}
            <div class="listone">{$v.name} <input whname="{$v.name}" type="radio" name="radio" value="{$v.r_id}"
                                                  id="bb{$k}"> <label for="bb{$k}"></label></div>
            {/foreach}
        </div>
    </div>
</div>
</body>

</html>

<script type="text/javascript">
    var search1 = '重庆';
    var search2 = '宜昌';
    /*字体大小rem*/
    (function (doc, win) {
        var docEl = doc.documentElement,
            resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
            recalc = function () {
                var clientWidth = docEl.clientWidth;
                if (!clientWidth) return;
                if (clientWidth >= 640) {
                    docEl.style.fontSize = '100px';
                } else {
                    docEl.style.fontSize = 100 * (clientWidth / 640) + 'px';
                }
            };

        if (!doc.addEventListener) return;
        win.addEventListener(resizeEvt, recalc, false);
        doc.addEventListener('DOMContentLoaded', recalc, false);
    })(document, window);
    /*城市选择 暂时不用*/
    // $('.search1').kuCity();
    // $('.search2').kuCity();
    /*时间选择*/
    $('.imgs2').hide();
    /*不可点击*/
    var myDate = new Date();
    var year = myDate.getFullYear();
    var month = myDate.getMonth() + 1;
    if (month <= 9) {
        month = '0' + month
    }
    var date = myDate.getDate();
    if (date <= 9) {
        date = '0' + date
    }
    $("#pickdate").val(year + "-" + month + '-' + date);
    $("#pickdate").dateDropper({
        animate: true,
        format: 'Y-m-d',
        minYear: year,
        maxYear: year + 10
    });
    $("#pickdate2").val(year + "-" + month + '-' + date);
    $("#pickdate2").dateDropper({
        animate: true,
        format: 'Y-m-d',
        minYear: year,
        maxYear: year + 10
    });
    /*$("#pickdate2").click(function(){
        console.log("执行了吗")
            const poppupNode = document.querySelector('.poppup')
             $("body").on("touchmove",function(e) {
                    //e.preventDefault();   
            });
            $(".dd-bottom").show(0,function(){
                $(".poppup").css('overflow','hidden');
            });
            poppupNode.addEventListener('touchmove', function (e) {
                    e.preventDefault()
            }, false)
    });*/
    $(".dd-bottom").click(function(){
        //console.log("执行了吗")
        const poppupNode = document.querySelector('.poppup');
        poppupNode.addEventListener('touchmove', function (e) {
            e.returnValue = true;
        }, false);
        $(".dd-bottom").hide(0,function(){
           $(".poppup").css('overflow','hidden');
         });
    });
    /*点击切换行程方向*/
    $(document).ready(function () {
        $(".imgboxA").click(function () {
            /*$(".imgboxA").toggle().hide();
            $('.imgboxB').toggle().show();*/
            var lcity = $('.search1').val();
            var rcity = $('.search2').val();
            $('.search1').val(rcity);
            $('.search2').val(lcity);
            search1 = rcity;
            search2 = lcity;
            //var riqi = year + '-' + month + '-' + date;
            var riqi = $("#pickdate").val();
            index_switch(search1, search2, riqi)
            $("#pickdate").val(riqi);
        });

    });


    //监听变化的情况
    $('#pickdate').change(function () {
        $(this).val();
        var dt = new Date($(this).val());
        var weekDay = ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六"];
        $('.spSty').val(weekDay[dt.getDay()]);
        var riqi = $("#pickdate").val();
        index_switch(search1, search2, riqi)
    });
    //赋值
    // 订单选择 时间
    $("#picksdate2").dateDropper({
        animate: true,
        format: 'Y-m-d',
        minYear: year,
        maxYear: year + 10
    });
    //进入初始赋值
    $("#picksdate").val(year + "-" + month + '-' + date);
     var sshh = new Date();
     var weekDay = ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六"];
     //$('.spSty').val(weekDay[sshh.getDay()+1]);
     $('.spSty').val('今天');
     

    $('#picksdate').change(function () {
        $(this).val();
        var dt = new Date($(this).val());
        var weekDay = ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六"];
        $('#spSty').val(weekDay[dt.getDay()]);
    });
    /*后一天;*******************************************************/
    $('.rtime').click(function () {
        var getdata = $("#pickdate").val().replace(/-/g, '/');//获取input时间转换为XXXX/XX/XX格式
        var needDate = new Date(getdata);//获取时间
        needDate.setDate(needDate.getDate() + 1);
        var ady = needDate.getFullYear();
        var adm = needDate.getMonth() + 1;
        if (adm <= 9) {
            adm = '0' + adm
        }
        var add = needDate.getDate();
        if (add <= 9) {
            add = '0' + add
        }
        if (ady == year && month == adm && add == date) {
            $('.imgs1').hide();
            $('.imgs2').show();
            $("#pickdate").val(ady + "-" + adm + '-' + add);
        } else {
            $('.imgs1').hide();
            $('.imgs2').show();
            $("#pickdate").val(ady + "-" + adm + '-' + add);
            var dt = new Date(ady, adm - 1, add);
            var weekDay = ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六"];
            $('.spSty').val(weekDay[dt.getDay()]);
        }
        var riqi = $("#pickdate").val();
        index_switch(search1, search2, riqi)
    });
    /*前一天*******************************************************/
    $('.ltime').click(function () {
        var getdata = $("#pickdate").val().replace(/-/g, '/');//获取input时间转换为XXXX/XX/XX格式
        var houdata = new Date(getdata);//获取时间
        houdata.setDate(houdata.getDate() - 1);
        var adsy = houdata.getFullYear();
        var adsm = houdata.getMonth() + 1;
        if (adsm <= 9) {
            adsm = '0' + adsm
        }
        var adsd = houdata.getDate();
        if (adsd <= 9) {
            adsd = '0' + adsd
        }
        if (adsy == year && month == adsm && adsd < date) {
            $('.imgs1').show();
            $('.imgs2').hide();
        } else {
            $('.imgs2').show();
            $('.imgs1').hide();
            $("#pickdate").val(adsy + "-" + adsm + '-' + adsd);
            var dt = new Date(adsy, adsm - 1, adsd);
            var weekDay = ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六"];
            $('.spSty').val(weekDay[dt.getDay()]);
        }
        var riqi = $("#pickdate").val();
        index_switch(search1, search2, riqi)

    })
    /*遍历去掉右边边距*/
    $('.typeOne').each(function (i) {
        var imde = i + 1;
        if (imde % 3 == 0) {
            $(this).css('margin-right', '0%')
        }
    });
    /*引入日历*/
    var myCalendar = new SimpleCalendar('#containerone');

    var myCalendar = new SimpleCalendar('.containertwo');
    /*展开堆叠*/
    $(document).ready(function () {
        $(".navBtn").click(function () {
            $(".navsmodel").slideToggle(400);
        });
    });
    $('.navsmodel').click(function () {
        $('.navsmodel').slideUp(400);
    });
    /*拨打电话*/
    $('.callbtn').click(function () {
        var tel = $('.callbtn').attr('tel');
        window.location.href = "tel:" + tel
    })

    //切换日期获取豪华游轮
    function index_switch(search1, search2, riqi) {
        $.post('{:url("index/indexSwitch")}',
            {search1: search1, search2: search2, riqi: riqi},
            function (data) {
                $(".chooseType").empty();
                if (data.code == 1) {
                    var html1 = '';
                    var list = data.data;
                    if (list != '') {
                        $.each(list, function (k, p) {
                            var ht = "{:url('rich/richDetail')}?s_id="+ p.s_id;

                            html1 += "<div class='typeOne typeOne0'>";
                            html1 += "<a href='" + ht + "'>";
                            html1 += "<span>" + p.r_name + "</span>";
                            html1 += "<span>RMB" + p.reference_price + "</span>";
                            html1 += "</a>";
                            html1 += "</div>";
                            $('.chooseType').html(html1);
                        });
                        /*遍历去掉右边边距*/
                        $('.typeOne').each(function (i) {
                            var imde = i + 1;
                            if (imde % 3 == 0) {
                                $(this).css('margin-right', '0%')
                            }
                        });

                    } else {
                        html1 += "<div class='noShip'>今日无船开航</div>";
                        $('.chooseType').html(html1);
                    }
                }

            });
        return false;
    }

    var rpage = 1;
    var cpage = 1;
    /*选择船*/
    $('.chosec').click(function (e) {
        $('.shipBox').slideDown(400);
    });
    /*关闭船*/
    $('.listone').click(function () {
        var whname = $('input[name="radio"]:checked').attr('whname');
        $('.shipBox').slideUp(400);
        $('.chosec').html(whname);
        rich_one(whname)
        $("#rich_more").show();
        rpage = 1;
    });

    /*航期1*/
    $('.scheduleone').click(function () {
        $(".typevoyaone").slideToggle(400);
        if ($(this).hasClass('ontype')) {
            $(this).removeClass("ontype");
        } else {
            $(this).addClass("ontype");
        }
        var s_id = $(this).attr('s_id');
        ship_schedule(s_id);
    });

    //游轮查看航期
    function ship_schedule(s_id,flag = true,target = '#containerone') {
        //获取目标，不能直接传入参数，直接传入参数会导致获取不到目标元素
        if (target == '#containerone'){
            var myCalendar = new SimpleCalendar('#containerone');
        }
        if (target == '.containertwo'){
            var tmp = '#containertwo_'+ s_id;
            //console.log(tmp);
            var myCalendar = new SimpleCalendar(tmp);
        }
        //console.log(s_id);
        myCalendar.deleteMark();
        $.post('{:url("index/shipSchedule")}',
            {s_id: s_id},
            function (data) {
                if (data.code == 1) {
                    var list1 = data.data.data1;
                    var list2 = data.data.data2;
                    if (list1 != '' && flag) {
                        $.each(list1, function (k, p) {
                            myCalendar.addMark(p.nianyueri, '0');
                        });
                    }

                    if (list2 != '' && !flag) {
                        $.each(list2, function (k, p) {
                            myCalendar.addMark(p.nianyueri, '0');
                        });
                    }
                }
            });

        return false;
    }

    //选择一次系列更新一条豪华游轮
    function rich_one(whname) {
        $.post('{:url("index/richOne")}',
            {whname: whname},
            function (data) {
                if (data.code == 1) {
                    $(".rich_one").empty();
                    var html2 = '';
                    var list = data.data;
                    var ht2 = "{:url('rich/richDetail')}?s_id="+ list[0].s_id; 

                    html2 += "<div class='banImg'>";
                    html2 += "<a href='" + ht2 + "'><img src='/uploads/images/" + list[0].s_img + "' alt=''></a>";
                    html2 += "</div>";
                    html2 += "<div class='btnBox'>";
                    html2 += "<div class='btns scheduleone' s_id='" + list[0].s_id + "'>航期</a></div>";
                    html2 += "<div class='btns cenBtn'><a  href='" + ht2 + "'>介绍</a></div>";
                    html2 += "<div class='btns yuding' s_id='" + list[0].s_id + "'>预订</div>";
                    html2 += "</div>";
                    html2 += "<div class='nabox'>";
                    html2 += "<span>" + list[0].r_name + "</span> <span>¥" + list[0].reference_price + "起</span>";
                    html2 += "</div>";
                    html2 += "<div class='voyage hoemvoi typevoyaone'>";
                    html2 += "<div class='containertwo' id='containertwo_"+ list[0].s_id +"'></div>";
                    html2 += "<div class='chooseArea'>";
                    html2 += "<div class='leshows' onclick='leshows(" +list[0].s_id+")'>‹</div>";
                    html2 += "<span class='contss  hide'>宜昌到重庆</span>";
                    html2 += "<span class='contshow show'>重庆到宜昌</span>";
                    html2 += "<div class='leshows' onclick='leshows(" +list[0].s_id+")'>›</div>";
                    html2 += "</div>";
                    html2 += "</div>";
                    $('.rich_one').html(html2);
                }

                /*航期1*/

                $('.scheduleone').click(function () {
                    $('.typevoyaone').slideToggle(400);
                    if ($(this).hasClass('ontype')) {
                        $(this).removeClass("ontype");
                    } else {
                        $(this).addClass("ontype");
                    }
                    var s_id = $(this).attr('s_id');
                    ship_schedule(s_id,true,'.containertwo');
                });

                /*订票*/
                $('.yuding').click(function (e) {
                    $('.poppup').slideDown(400);
                    $(".poppup").on("touchmove",function(e) {
                            e.preventDefault();   
                    });
                    $(".poppup").show(0,function(){
                         $("body").css('overflow','hidden');
                    });
                    
                    var s_id = $(this).attr('s_id');
                    ship_detail(s_id);
                });
                /*关闭订票*/
                $('.turnoff').click(function () {
                    $('.poppup').slideUp(400);
                     $(".poppup").hide(0,function(){
                        $("body").css('overflow','scroll');
                    });
                });


            });
        return false;
    }

    //点击更多豪华游轮
    $('#rich_click').click(function () {
        var r_id = $('input[name="radio"]:checked').val();
        $.post('{:url("index/richClick")}',
            {r_id: r_id, rpage: rpage},
            function (data) {
                if (data.code == 1) {
                    var html3 = '';
                    var list = data.data.data;
                    if (list != '') {
                        $.each(list, function (k, p) {
                            var ht3 = "{:url('rich/richDetail')}?s_id="+ p.s_id; 

                            html3 += "<div class='banImg'>";
                            html3 += "<a href='" + ht3 + "'><img src='/uploads/images/" + p.s_img + "' alt=''></a>";
                            html3 += "</div>";
                            html3 += "<div class='btnBox'>";
                            html3 += "<div class='btns scheduleone00' s_id='" + p.s_id + "'>航期</a></div>";
                            html3 += "<div class='btns cenBtn'><a  href='" + ht3 + "'>介绍</a></div>";
                            html3 += "<div class='btns yuding' s_id='" + p.s_id + "'>预订</div>";
                            html3 += "</div>";
                            html3 += "<div class='nabox'>";
                            html3 += "<span>" + p.r_name + "</span> <span>¥" + p.reference_price + "起</span>";
                            html3 += "</div>";
                            html3 += "<div class='voyage hoemvoi typevoyaone222'>";
                            html3 += "<div class='containertwo' id='containertwo_"+ p.s_id +"'></div>";
                            html3 += "<div class='chooseArea'>";
                            html3 += "<div class='leshows' s_id='" + p.s_id + "' onclick='leshows(" +p.s_id+")'>‹</div>";
                            html3 += "<span class='contss  hide'>宜昌到重庆</span>";
                            html3 += "<span class='contshow show'>重庆到宜昌</span>";
                            html3 += "<div class='leshows' s_id='" + p.s_id + "' onclick='leshows(" +p.s_id+")'>›</div>";
                            html3 += "</div>";
                            html3 += "</div>";

                        });
                        $('.rich_one').append(html3);
                        rpage++;

                    } else {
                        //无数据更多隐藏
                        $("#rich_more").hide();
                        return false;
                    }
                }
                $('.scheduleone00').click(function () {
                    if ($(this).hasClass('ontype')) {
                        $(this).removeClass("ontype");
                    } else {
                        $(this).addClass("ontype");
                    }
                    $(this).parent().next().next().slideToggle(400);
                    var s_id = $(this).attr('s_id');
                    ship_schedule(s_id,true,'.containertwo');
                });

                /*订票*/
                $('.yuding').click(function (e) {
                    $('.poppup').slideDown(400);
                     $(".poppup").on("touchmove",function(e) {
                            e.preventDefault();   
                               
                    });
                    $(".poppup").show(0,function(){
                         $("body").css('overflow','hidden');
                    });
                    var s_id = $(this).attr('s_id');
                    ship_detail(s_id);
                });
                /*关闭订票*/
                $('.turnoff').click(function () {
                    $('.poppup').slideUp(400);
                     $(".poppup").hide(0,function(){
                        $("body").css('overflow','scroll');
                    });
                });

                /*
                //点击切换行程方向
                $('.leshows').click(function () {
                    var s_id = $(this).attr('s_id');
                    console.log(999)
                    //删除标记
                    // console.log(s_id);
                    if ($('.contss').hasClass('hide')) {
                        $('.contss').removeClass('hide');
                        $('.contss').addClass('show');
                        $('.contshow').removeClass('show');
                        $('.contshow').addClass('hide');
                        //重庆到宜昌
                        ship_schedule(s_id,false,'.containertwo');
                    } else {
                        $('.contss').removeClass('show');
                        $('.contss').addClass('hide');
                        $('.contshow').removeClass('hide');
                        $('.contshow').addClass('show');
                        //宜昌到重庆
                        ship_schedule(s_id,true,'.containertwo');
                    }
                });
                */

            });
        return false;

    });

    //点击更多普通游轮
    $('#common_click').click(function () {
        $.post('{:url("index/commonClick")}',
            { cpage: cpage},
            function (data) {
                if (data.code == 1) {
                    var html4 = '';
                    var list = data.data.data;
                    if (list != '') {
                        $.each(list, function (k, p) {
                            var ht4 = "{:url('common/commonDetail')}?s_id="+ p.s_id; 

                            html4 += "<div class='banImg'>";
                            html4 += "<a href='" + ht4 + "'><img src='/uploads/images/" + p.s_img + "' alt=''></a>";
                            html4 += "</div>";
                            html4 += "<div class='btnBox'>";
                            html4 += "<div class='btns scheduleone00' s_id='" + p.s_id + "'>航期</a></div>";
                            html4 += "<div class='btns cenBtn'><a  href='" + ht4 + "'>介绍</a></div>";
                            html4 += "<div class='btns yuding' s_id='" + p.s_id + "'>预订</div>";
                            html4 += "</div>";
                            html4 += "<div class='nabox'>";
                            html4 += "<span>" + p.p_name + "</span> <span>¥" + p.reference_price + "起</span>";
                            html4 += "</div>";
                            html4 += "<div class='voyage hoemvoi typevoyaone222'>";
                            html4 += "<div class='containertwo' id='containertwo_"+ p.s_id +"'></div>";
                            html4 += "<div class='chooseArea'>";
                            html4 += "<div class='leshows' s_id='" + p.s_id + "' onclick='leshows(" +p.s_id+")'>‹</div>";
                            html4 += "<span class='contss  hide'>宜昌到重庆</span>";
                            html4 += "<span class='contshow show'>重庆到宜昌</span>";
                            html4 += "<div class='leshows' s_id='" + p.s_id + "' onclick='leshows(" +p.s_id+")'>›</div>";
                            html4 += "</div>";
                            html4 += "</div>";

                        });
                        $('.common_one').append(html4);
                        cpage++;

                    } else {
                        //无数据更多隐藏
                        $("#common_more").hide();
                        return false;
                    }
                }
                $('.scheduleone00').click(function () {
                    if ($(this).hasClass('ontype')) {
                        $(this).removeClass("ontype");
                    } else {
                        $(this).addClass("ontype");
                    }
                    $(this).parent().next().next().slideToggle(400);
                    var s_id = $(this).attr('s_id');
                    ship_schedule(s_id,true,'.containertwo');
                });

                /*订票*/
                $('.yuding').click(function (e) {
                    $('.poppup').slideDown(400);
                     $(".poppup").on("touchmove",function(e) {
                             e.preventDefault(); 
                               
                    });
                     $(".poppup").show(0,function(){
                         $("body").css('overflow','hidden');
                    });
                    
                    var s_id = $(this).attr('s_id');
                    ship_detail(s_id);
                });
                /*关闭订票*/
                $('.turnoff').click(function () {
                    $('.poppup').slideUp(400);
                     $(".poppup").hide(0,function(){
                        $("body").css('overflow','scroll');
                    });
                });

                /*
                //点击切换行程方向
                $('.leshows').click(function () {
                    var s_id = $(this).attr('s_id');
                    console.log(999)
                    //删除标记
                    // console.log(s_id);
                    if ($('.contss').hasClass('hide')) {
                        $('.contss').removeClass('hide');
                        $('.contss').addClass('show');
                        $('.contshow').removeClass('show');
                        $('.contshow').addClass('hide');
                        //重庆到宜昌
                        ship_schedule(s_id,false,'.containertwo');
                    } else {
                        $('.contss').removeClass('show');
                        $('.contss').addClass('hide');
                        $('.contshow').removeClass('hide');
                        $('.contshow').addClass('show');
                        //宜昌到重庆
                        ship_schedule(s_id,true,'.containertwo');
                    }
                });
                */

            });
        return false;

    });



    function leshows(s_id){
        //删除标记
        // console.log(s_id);
        if ($('.contss').hasClass('hide')) {
            $('.contss').removeClass('hide');
            $('.contss').addClass('show');
            $('.contshow').removeClass('show');
            $('.contshow').addClass('hide');
            //重庆到宜昌
            ship_schedule(s_id,false,'.containertwo');
        } else {
            $('.contss').removeClass('show');
            $('.contss').addClass('hide');
            $('.contshow').removeClass('hide');
            $('.contshow').addClass('show');
            //宜昌到重庆
            ship_schedule(s_id,true,'.containertwo');
        }
        return false;
    }

    /*航期2*/
    $('.scheduletwo').click(function () {
        $(".typevoyatwo").slideToggle(400);
        if ($(this).hasClass('ontype')) {
            $(this).removeClass("ontype");
        } else {
            $(this).addClass("ontype");
        }
        var s_id = $(this).attr('s_id');
        ship_schedule(s_id,true,'.containertwo');
    });

    //点击切换行程方向
    $('.leshows').click(function () {
        var s_id = $(this).attr('s_id');
        if ($('.contss').hasClass('hide')) {
            $('.contss').removeClass('hide');
            $('.contss').addClass('show');
            $('.contshow').removeClass('show');
            $('.contshow').addClass('hide');
            //重庆到宜昌
            if ($('.leshows').hasClass('s_t')){
                ship_schedule(s_id,false,'.containertwo');
            } else {
                ship_schedule(s_id,false);
            }

        } else {
            $('.contss').removeClass('show');
            $('.contss').addClass('hide');
            $('.contshow').removeClass('hide');
            $('.contshow').addClass('show');
            //宜昌到重庆
            if ($('.leshows').hasClass('s_t')){
                ship_schedule(s_id,true,'.containertwo');
            } else {
                ship_schedule(s_id,true);
            }
        }

    });

    /*订票*/
    $('.yuding').click(function (e) {
         $('.poppup').slideDown(400);
         $(".poppup").on("touchmove",function(e) {
                            e.preventDefault();                                
         });
         $(".poppup").show(0,function(){
            $("body").css('overflow','hidden');
            });
        var s_id = $(this).attr('s_id');
        ship_detail(s_id);
    });
    /*关闭订票*/
    $('.turnoff').click(function () {
        $('.poppup').slideUp(400);
         $(".poppup").hide(0,function(){
                $("body").css('overflow','scroll');
        });
    });

    /*选择方向*/
    $('.direction').click(function(){
            if($(this).hasClass('chooseWay')){
                
            }else {
                $(this).addClass("chooseWay").siblings().removeClass("chooseWay");
            }
            var start = $('.chooseWay').attr('start');
            var s_id = $('#s_id').val();
            var riqi = year+'-'+month+'-'+date;
            $("#pickdate2").val(riqi);
            $('#spSty2').val('今天');
            ship_switch(start,s_id,riqi)

            
    }); 

    //监听变化的情况
    $('#pickdate2').change(function(){
            var start = $('.chooseWay').attr('start');
            var s_id = $('#s_id').val();
            $(this).val();
            var dt = new Date($(this).val());
            var weekDay = ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六"];
            $('#spSty2').val(weekDay[dt.getDay()]);
            var riqi = $("#pickdate2").val();
            ship_switch(start,s_id,riqi)
    });

    //当前游轮预订信息
    function ship_detail(s_id) {
        $.post('{:url("index/shipDetail")}',
            {s_id: s_id},
            function (data) {
                if (data.code == 1) {
                    var list = data.data;
                    if (list.s_type==1) {
                        $('.shipsName').html(list.r_name)
                    }else{
                        $('.shipsName').html(list.p_name)
                    }
                    var s_id = list.s_id;
                    $('#s_id').val(s_id);
                    var date2 = myDate.getDate();
                    if (date2 <= 9) {
                        date2 = '0' + date2
                    }
                    var riqi2 = year+'-'+month+'-'+date2;
                    $("#pickdate2").val(riqi2);
                    $('#spSty2').val('今天');
                }
            });
    }

    //获取所选的行程信息
    function ship_switch(start,s_id,riqi){
        $.post('{:url("index/shipSwitch")}',
        {start:start,s_id:s_id,riqi:riqi},
        function(data){
            $('#adult_money').html('0');
            $('#child_money').html('0');
            $('#totalNum').val('0.00');
            $('#quantity').val('0');
            $('#childc').val('0');
            if(data.code==1){
                if (data.data.data1=='') {
                    //alert('当前游轮今日无行程')
                    return;
                }
                if (data.data.data1[0] != '') {
                    var list = data.data.data1[0];
                    var adult_money = list.adult_money;
                    var child_money = list.child_money;
                    var v_id = list.v_id;
                    $('#adult_money').html(adult_money);
                    $('#child_money').html(child_money);
                    $('#v_id').val(v_id);
                    
                }else{
                    //alert('当前游轮今日无行程')
                    //return;
                }
            }       
            
        });
        return false;
    }

    /*计算成人价格*/
    $(function () {
        var t = $("#quantity");
        var chone = $("#childc");
        $("#addNum").click(function () {
            t.val(parseInt(t.val()) + 1);
            $("#minNum").removeAttr("disabled");                 //当按加1时，解除$("#min")不可读状态
            $("#minNum").removeClass('noadd');
            setTotal();
        })
        $("#minNum").click(function () {
            if (parseInt(t.val()) == 1) {
                $("#minNum").addClass('noadd');
            }
            if (parseInt(t.val()) > 0) {                     //判断数量值大于1时才可以减少
                t.val(parseInt(t.val()) - 1)
            } else {
                $("#minNum").attr("disabled", "disabled");        //当$("#min")为1时，$("#min")不可读状态
            }
            setTotal();
        })

        function setTotal() {
            var adult_money = $('#adult_money').html();
            var child_money = $('#child_money').html(); 
            $("#totalNum").val((parseInt(t.val())*adult_money+(chone.val())*child_money).toFixed(2));  //成人单价2250
        }

        setTotal();
    });
    /*计算儿童价格*/
    $(function () {
        var man = $("#quantity");
        var child = $("#childc");
        $("#childadd").click(function () {
            child.val(parseInt(child.val()) + 1);
            $("#childmin").removeAttr("disabled");                 //当按加1时，解除$("#min")不可读状态
            $("#childmin").removeClass('noadd');
            setTotal();
        })
        $("#childmin").click(function () {
            if (parseInt(child.val()) == 1) {
                $("#childmin").addClass('noadd');
            }
            if (parseInt(child.val()) > 0) {                     //判断数量值大于1时才可以减少
                child.val(parseInt(child.val()) - 1)
            } else {
                $("#childmin").attr("disabled", "disabled");        //当$("#min")为1时，$("#min")不可读状态
            }
            setTotal();
        })

        function setTotal() {
            var adult_money = $('#adult_money').html();
            var child_money = $('#child_money').html(); 
            $("#totalNum").val((parseInt(child.val())*child_money+(man.val())*adult_money).toFixed(2));  //儿童单价1150
        }

        setTotal();
    });

    /*选择方向*/
    $('.direction').click(function () {
        if ($(this).hasClass('chooseWay')) {

        } else {
            $(this).addClass("chooseWay").siblings().removeClass("chooseWay");
        }
    });

    //提交信息
    $('#sub2').click(function(){
        var v_id = $('#v_id').val();
        var riqi = $("#pickdate2").val();
        var adult_money = $('#adult_money').html();
        var child_money = $('#child_money').html();
        var quantity = $('#quantity').val();
        var childc = $('#childc').val(); 
        var username = $('#username').val(); 
        var telphone = $('#telphone').val(); 
        /*if (riqi=='') {
            alert('请选择出游时间')
            return;
        }
        if (adult_money=='0') {
            alert('当前游轮今日无行程')
            return;
        }
        if (quantity=='0') {
            alert('成人参团人数不能为空')
            return;
        }*/
        if (username=='') {
            alert('姓名不能为空')
            return;
        }
        if (telphone=='') {
            alert('手机号码不能为空')
            return;
        }
        if (telphone.length!=11) {
            alert('手机号码输入有误')
            return;
        }
        $.post('{:url("index/shipSub2")}',
        {v_id:v_id,start_time:riqi,adult_moneys:adult_money,children_moneys:child_money,
            adult_num:quantity,children_num:childc,username:username,telphone:telphone},
        function(data){
            if(data.code==1){
                alert('预订成功')
                window.location.href="{:url('index/index')}";
            }       
            
        });
    });

</script>